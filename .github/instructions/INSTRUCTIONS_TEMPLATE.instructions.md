---
applyTo: "<填写生效的 Glob 模式，例如 setup/**/*.sh>"
description: "<一句话描述此说明文件的目的，与实际目录或任务对应>"
---
# 使用指南模版

> 将本模版复制后按需替换占位符，删除不适用的段落；保持标题结构有助于 Copilot 更好地解析上下文。

## 背景与目标
- 背景：<解释脚本所属场景，例如“macOS 初始化脚本，需要兼容 ARM 与 Intel”>
- 目标：<列出希望 Copilot 生成/修改代码时优先满足的目标，例如“保障幂等性、提供耗时统计”>

## 适用范围
- 文件/目录：<列出关键目录或文件类型，例如 `setup/`、`maintain/`>
- 关键约束：
  - macOS 版本：<例如 "兼容 macOS 14+">  
  - Shell 类型：<例如 `bash` (macOS 3.2) / `zsh`>
  - 其他业务约束：<如网络访问、磁盘空间、权限等>

## 代码风格要求
### 头部与基础设置
- Shebang：<指定 `#!/bin/bash` 或 `#!/bin/zsh`>
- 严格模式：<说明 `set -euo pipefail` 或等效处理>
- 路径注释：保留 `# filepath: ...` 并同步更新。

### 日志与输出
- 统一引入：<例如 `source "$SCRIPT_DIR/../lib/colors.sh"`>
- 日志函数：<列出需使用的函数 `print_header`/`info`/`success` 等>
- 输出语言：默认中文，英文仅用于命令、文件名。

### 命名规范
- 函数命名：<例如全小写加下划线>
- 局部变量：使用 `local`，避免全局污染。
- 常量/数组：<说明命名方式或放置位置>

## 功能与结构约束
### 依赖检测
- 在执行前使用 `<命令，例如 command -v>` 检查依赖，缺失时给出解决方案。

### 参数与开关
- 支持的参数：<列出必填/可选参数、默认值>
- 幂等保障：<描述如何处理已存在的资源，如使用 `--force`>

### 复用组件
- 复用库：<列出必须调用的辅助库或函数，例如 `setup/lib/brew_helpers.sh`>
- 避免重复实现：<说明已有的工具或模式需优先使用>

## 错误处理与提示
- 异常输出：<例如失败时调用 `error` 并写入日志文件>
- 重试逻辑：<说明是否需要重试、等待策略>
- 长耗时任务：<提供进度提示、允许中断或恢复>

## 验证与交付
- 运行前检查：`zsh -n <script>` / `bash -n <script>`
- Lint：`./lint/lint_shell.sh [--fix]`
- 其他：<如单元测试、手动验证步骤>

## 推荐 Prompt
- “根据以上规范，在 `<路径>` 创建新脚本，支持参数 ...”
- “请在遵循‘代码风格要求’的前提下，为 `<函数>` 添加日志与依赖检查。”
- “为 `<文件>` 增加幂等处理，并保持错误处理符合‘错误处理与提示’章节。”

## 维护说明
- 负责人：<团队或个人>  
- 更新频率：<例如“季度复查”>
- 历史记录：<可选，记录重要变更>
